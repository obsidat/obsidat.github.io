{
  "lexicon": 1,
  "id": "io.github.obsidat.file",
  "defs": {
    "main": {
      "type": "record",
      "key": "any",
      "description": "An Obsidian file. Its file path, vault name, and contents are encrypted using a passphrase stored in the settings of the atproto-obsidian-sync Obsidian plugin.\nBefore encrypting, the passphrase is concatenated as `passphrase || rkey` to make it unique per-file.\nRecord Key is blake3 hash of `lower(filePath) || ':' || lower(vaultName) || ':' || passphrase || ':' || salt` The salt is currently hardcoded in the plugin but this may change in the future.",
      "record": {
        "type": "object",
        "required": [
          "body",
          "path",
          "recordCreatedAt",
          "fileLastCreatedOrModified"
        ],
        "properties": {
          "version": {
            "type": "integer",
            "description": "A newer version file always overrides an older version file. `undefined` is the lowest version."
          },
          "body": {
            "type": "blob",
            "description": "The AGE encrypted file contents."
          },
          "path": {
            "type": "bytes",
            "description": "The AGE encrypted file path and vault name in the form `vaultName || ':' || filepath`"
          },
          "referencedFilePassphrases": {
            "type": "bytes",
            "description": "An AGE encrypted CBOR key-value mapping from internally linked file -> file passphrase."
          },
          "recordCreatedAt": {
            "type": "string",
            "format": "datetime",
            "description": "This record's creation date."
          },
          "fileLastCreatedOrModified": {
            "type": "string",
            "description": "The file's creation or modification date."
          }
        }
      }
    }
  }
}